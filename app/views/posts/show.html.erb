
<section style="background-color: #eee;">
  <div class="container my-5 py-5">
    <div class="row d-flex justify-content-center">
      <div class="col-md-12 col-lg-10 col-xl-8">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-start align-items-center">              
              <% if @post.user.image.present? %>
                <%= image_tag @post.user.image.url, class: "rounded-circle shadow-1-strong me-3", style: "width: 60px; height: 60px;"%>
                <% else %>                
               <img class="rounded-circle shadow-1-strong me-3"
                src="<%= asset_path("avatar.png")%>" alt="avatar" width="60" height="60" />
              <% end %>
              <!-- <img class="rounded-circle shadow-1-strong me-3"
                src="https://mdbcdn.b-cdn.net/img/Photos/Avatars/img%20(19).webp" alt="avatar" width="60" height="60" /> -->
              <div>
                <h6 class="fw-bold text-primary mb-1">
                  <p>
                   <%# byebug %>
                   <%= @post.user.first_name %>
                   <%= @post.user.last_name %>
                  </p>
                </h6>
                <p class="text-muted small mb-0">
                  Shared publicly - <%= @post.created_at.strftime("%d-%b-%Y / %R") %>
                </p>
              </div>
            </div>
            <div class="d-flex ">              
              <p class="col-md-7">
                <strong>Title:</strong>
                <%= @post.title %>
              </p>

              <p class="col-md-5">
                <strong>Description:</strong>
                <%= @post.description %>
              </p>
              <!-- 
              <p>
                <strong>user_id:</strong>
                <%#= @post.user_id %>
              </p> -->
            </div>

            <p class="mt-3 mb-4 pb-2">  
              <!-- <strong >Pictures:</strong> -->
              <% if @post.pictures.present? %>
                <% @post.pictures.each do |pic| %> 
                  <%= image_tag pic.image.url, style: "width: 700px; height: 400px; " %>
                <% end %>
                <% else %>
                  <img src="<%= asset_path("imageleptop.jpeg")%>" alt="avatar" style= "width: 700px; height: 400px; " />                
              <%end %>
            </p>

            <div class="small d-flex justify-content-start">
              <div class="like_section">
                <% if !Like.where(post_id: @post.id, :user_id=>current_user.id).present? %>
                  <a href="/like?post_id=<%= @post.id%>" class="d-flex align-items-center me-3" data-remote="true">
                    <i class="far fa-thumbs-up me-2"></i>
                    <p class="mb-0">Like <small>(<%= @post.likes.count%>)</small></p>
                  </a>
                <% else %>
                  <a href="/unlike?post_id=<%= @post.id%>" class="d-flex align-items-center me-3" data-remote="true">
                    <i class="far fa-thumbs-down me-2"></i>
                    <p class="mb-0">Like<small>(<%= @post.likes.count%>)</small></p>
                  </a>
                <% end %>
              </div>
              <a href="#!" class="d-flex align-items-center me-3">
                <i class="far fa-comment-dots me-2"></i>
                <p class="mb-0" onclick="document.getElementById('id01').style.display='block'">Comment:(<b><%= @post.comments.count %></b>)</p>

              </a>
              <a href="#!" class="d-flex align-items-center me-3">
                <i class="fas fa-share me-2"></i>
                <p class="mb-0">Share</p>                
              </a>              
            </div>
            <div class="float-end">
              <%= link_to 'Edit comment', edit_post_path(@post),class: "btn btn-primary btn-sm" %>
              <%= link_to 'Back', posts_path, class: "btn btn-dark btn-rounded" %>
            </div>
          </div>          
        </div>
      </div>
    </div>
  </div>
</section>

<div id="id01" class="w3-modal">
  <div class="w3-modal-content w3-card-4 w3-animate-zoom">
    <header class="w3-container w3-blue"> 
     <span onclick="document.getElementById('id01').style.display='none'" 
     class="w3-button w3-blue w3-xlarge w3-display-topright">&times;</span>
     <h2>Instagrame comment</h2>
    </header>

    <div class="w3-bar w3-border-bottom">
     <button class="tablink w3-bar-item w3-button" onclick="openCity(event, 'London')">Do comment</button>
     <button class="tablink w3-bar-item w3-button" onclick="openCity(event, 'Paris')">comment list</button>   
    </div>

    <div id="London" class="w3-container city">
      <%= form_with model: [ @post, @post.comments.build ] do |form| %>
        <%= form.hidden_field :user_id , value: current_user.id %>
        <div class="w3-container" action="/action_page.php">
          <div class="w3-section">
            <label><b>comment :-</b></label>
            <%= form.text_field :title , class: "form-control", id: "recipient-name"%>         
            <%= form.submit class: "w3-button w3-block w3-green w3-section w3-padding" %>
          </div>
        </div>
        <div>
        <% @post.comments.each do |comment| %>
          <p>
            <strong><%= comment&.user&.user_name %></strong>
            <%= comment.title %>
          </p>           
        <% end %>
      </div>   
      <% end %> 
    </div>

    <div id="Paris" class="w3-container city">
      <div>
        <% @post.comments.each do |comment| %>
          <p>
            <strong><%= comment&.user&.user_name %></strong>
            <%= comment.title %>
          </p>
          <p>
            <%= link_to 'Delete', "/comments/#{comment.id}?post_id=#{@post.id}", method: :delete, data: { confirm: 'Are you sure?' } %>
          </p>          
        <% end %>
      </div>
    </div>
    <div class="w3-container w3-light-grey w3-padding">
     <button class="w3-button w3-right w3-white w3-border" 
     onclick="document.getElementById('id01').style.display='none'">Close</button>
    </div>
  </div>
</div>



<script>
  document.getElementById("London").onsubmit = function(){
    location.reload(true);
}

document.getElementsByClassName("tablink")[0].click();

function openCity(evt, cityName) {
  var i, x, tablinks;
  x = document.getElementsByClassName("city");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablink");
  for (i = 0; i < x.length; i++) {
    tablinks[i].classList.remove("w3-light-grey");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.classList.add("w3-light-grey");
}
</script>
